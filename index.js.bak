// Note that a dynamic `import` statement here is required due to
// webpack/webpack#6615, but in theory `import { greet } from './pkg/hello_world';`
// will work here one day as well!
const rust = import('./pkg/vt_js');

rust
  .then(m => {
    fetch('/20055.json')
    .then(response => {
        return response.json();
    })
    .then(cast => {
        let start = new Date();

        for (var i=0; i<10; i++) {
            let x = m.create(cast.width, cast.height);

            cast.stdout.forEach(frame => {
                x.feed(frame[1]);
                // console.log('fed: ' + frame[1]);
            });

            // console.log(x.inspect());
            console.log(x.dump());
        }

        let end_ = new Date();
        let t = (end_.getTime() - start.getTime()) / 10;

        console.log(t);

        // console.log(x.inspect());
    })
  }).catch(console.error);